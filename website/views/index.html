{% import '_helpers.html' as hh -%}

{% include '_header.html' -%}
<div class="container-fluid">
  <h1>Annotated genomic regions</h1>
  <h3>Candidate enhancers based on DNase and H3K27ac signals</h3>

  <div class="row">
    <div class="col-md-4">
      <p>DNase hypersensitivity and histone modification H3K27ac are well-known indicators of enhancer function. We have developed an unsupervised method that combines DNase and H3K27ac signals in the same cell type to predict enhancers. When tested on mouse transgenic assays, our method shows higher accuracy than DNase and H3K27ac individually. We have applied this method to 45 human cell types and 20 mouse cell types with both DNase and H3K27ac data generated by the ENCODE and Roadmap Epigenomic consortia. You can query these enhancers by genomic locations, nearby genes, or SNPs.
    </div>
    <div class="col-md-8">
      <img src="static/sample-image-v5.png">
    </div>
  </div>

  <div class="row">
    <div class="col-md-10">
      <div>
        <a href="#search"></a>
        <b>Search Candidate Enhancers</b>
        <form id="searchForm">

          <div id="selectAssembly" class="btn-group" data-toggle="buttons">
            <label class="btn btn-primary">
              <input type="radio" name="assembly" value="hg19" id="assembly_hg19">Human (hg19)
            </label>
            <label class="btn btn-primary active">
              <input type="radio" name="assembly" value="mm10" id="assembly_mm10" checked>Mouse (mm10)
            </label>
            <label class="btn btn-primary">
              <input type="radio" name="assembly" value="mm9" id="assembly_mm9">Mouse (mm9)
            </label>
          </div>

          <br>
          <br>
          <input type="text" name="loci" id="lociSearchBox" value="{{defaults["mm10"]["pos"]}}">&nbsp;<input type="submit" value="Search"><br>
          {% include "_examples.html" -%}

          <br>

          <div id="content">
            <div id="selectAssays" class="btn-group" data-toggle="buttons">
              <label class="btn btn-primary active">
                <input type="radio" name="assays" value="Both" id="assaysBoth" autocomplete="off" checked>DNase + H3K27ac
              </label>
              <label class="btn btn-primary">
                <input type="radio" name="assays" value="DNase" id="assaysDNase" autocomplete="off" >DNase
              </label>
              <label class="btn btn-primary">
                <input type="radio" name="assays" value="H3K27ac" id="assaysH3K27ac" autocomplete="off">H3K27ac
              </label>
            </div>
            <button type="button" class="btn btn-default btn-xs" id="selectAll">All</button>
            <button type="button" class="btn btn-default btn-xs" id="selectNone">None</button>
            <button type="button" class="btn btn-default btn-xs" id="selectNone"><a href="#" data-toggle="tooltip" title="" data-original-title="Selects cell types (below) that have peaks overlapping genes, SNPs, or coordinates in the search box">Intersecting</button>
            <br>

            {{ hh.tissueCheckboxes(epigenomes, "hg19", "Both", False) }}
            {{ hh.tissueCheckboxes(epigenomes, "hg19", "DNase", False) }}
            {{ hh.tissueCheckboxes(epigenomes, "hg19", "H3K27ac", False) }}
            {{ hh.tissueCheckboxes(epigenomes, "mm9", "Both", False) }}
            {{ hh.tissueCheckboxes(epigenomes, "mm9", "DNase", False) }}
            {{ hh.tissueCheckboxes(epigenomes, "mm9", "H3K27ac", False) }}
            {{ hh.tissueCheckboxes(epigenomes, "mm10", "Both", True) }}
            {{ hh.tissueCheckboxes(epigenomes, "mm10", "DNase", False) }}
            {{ hh.tissueCheckboxes(epigenomes, "mm10", "H3K27ac", False) }}

          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<br>


<script src="static/tablesort.min.js"></script>
<script>
  var selectorNames = {{epigenomes.SelectorNames()}};
  var annotationDefaults = {{defaults.json()}};
  {% include 'js.js' -%}
</script>
<script src="static/jquery.serialize-object.min.js"></script>

{% include '_footer.html' -%}
